<mvc:View
	controllerName="paymentprototype.controller.payment_prototype"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns:f="sap.f"
	xmlns:core="sap.ui.core"
	xmlns="sap.m"
	displayBlock="true"
	height="100%">
	<f:DynamicPage id="dynamicPageId" toggleHeaderOnTitleClick="false">
		<!-- Dynamic Page Title -->
		<f:title>
			<f:DynamicPageTitle id="dynamicPageTitle">
				<f:heading>
					<Title id="pageTitle" text="Hostel Payment System"/>
				</f:heading>
				<f:snappedContent>
					<Text id="snappedBalance" text="Outstanding: RM 3,500.00"/>
				</f:snappedContent>
				<f:expandedContent>
					<Text id="expandedWelcome" text="Welcome, Student"/>
				</f:expandedContent>
				<f:actions>
					<Button id="refreshBtn" icon="sap-icon://refresh" press=".onRefresh"/>
					<Button id="settingsBtn" icon="sap-icon://action-settings"/>
				</f:actions>
			</f:DynamicPageTitle>
		</f:title>

		<!-- Dynamic Page Header -->
		<f:header>
			<f:DynamicPageHeader id="dynamicPageHeader" pinnable="true">
				<VBox id="headerContentVBox">
					<!-- Outstanding Balance Card -->
					<VBox id="outstandingCardVBox" class="outstandingCard">
						<ObjectHeader
							id="balanceHeader"
							title="RM 3,500.00"
							intro="Total Outstanding"
							class="balanceObjectHeader">
							<statuses>
								<ObjectStatus id="paidStatus" text="4 Paid" state="Success"/>
								<ObjectStatus id="pendingStatus" text="2 Pending" state="Warning"/>
								<ObjectStatus id="overdueStatus" text="1 Overdue" state="Error"/>
							</statuses>
						</ObjectHeader>
					</VBox>

					<!-- Payment Alerts -->
					<VBox id="alertsVBox" class="sapUiSmallMarginTop">
						<MessageStrip
							id="overdueMessageStrip"
							text="1 payment is overdue. Please settle immediately to avoid penalties."
							type="Error"
							showIcon="true"
							class="sapUiTinyMarginBottom"/>
						<MessageStrip
							id="upcomingMessageStrip"
							text="2 payments due within 3 days. Review your bills below."
							type="Warning"
							showIcon="true"/>
					</VBox>
				</VBox>
			</f:DynamicPageHeader>
		</f:header>

		<!-- Main Content -->
		<f:content>
			<VBox id="mainContentVBox" class="sapUiSmallMargin">
				<!-- Icon Tab Bar for Filtering -->
				<IconTabBar
					id="billsTabBar"
					select=".onTabSelect"
					class="sapUiResponsiveMargin">
					<items>
						<IconTabFilter
							id="allTab"
							key="All"
							text="All"
							count="{/allCount}"/>
						<IconTabSeparator id="tabSeparator1"/>
						<IconTabFilter
							id="overdueTab"
							key="Overdue"
							text="Overdue"
							count="{/overdueCount}"
							iconColor="Negative"/>
						<IconTabFilter
							id="pendingTab"
							key="Pending"
							text="Pending"
							count="{/pendingCount}"
							iconColor="Critical"/>
					</items>
				</IconTabBar>

				<!-- Bills Table -->
				<Panel id="billsPanel" headerText="Your Bills" class="sapUiResponsiveMargin">
					<Table
						id="billsTable"
						items="{
							path: 'bills>/',
							sorter: { path: 'dueDate' }
						}"
						mode="None"
						class="sapUiResponsiveMargin">
						<columns>
							<Column id="descriptionCol" width="30%">
								<Text id="descriptionColHeader" text="Fee Description"/>
							</Column>
							<Column id="dueDateCol" width="15%">
								<Text id="dueDateColHeader" text="Due Date"/>
							</Column>
							<Column id="amountCol" width="15%">
								<Text id="amountColHeader" text="Amount"/>
							</Column>
							<Column id="statusCol" width="15%">
								<Text id="statusColHeader" text="Status"/>
							</Column>
							<Column id="actionsCol" width="25%">
								<Text id="actionsColHeader" text="Actions"/>
							</Column>
						</columns>
						<items>
							<ColumnListItem id="billItem">
								<cells>
									<VBox id="descriptionVBox">
										<Text id="feeTypeText" text="{bills>feeType}" class="sapUiTinyMarginBottom"/>
										<Text id="feeDescText" text="{bills>description}" class="sapUiTinyText"/>
									</VBox>
									<Text id="dueDateText" text="{bills>dueDate}"/>
									<Text
										id="amountText"
										text="{bills>currency}{bills>amount}"
										class="sapUiMediumMarginBegin sapThemeHighlight-asColor"/>
									<ObjectStatus
										id="statusObject"
										text="{bills>status}"
										state="{path: 'bills>status', formatter: '.formatStatus'}"/>
									<HBox id="actionButtonsHBox">
										<Button
											id="payNowBtn"
											text="Pay Now"
											type="Emphasized"
											icon="sap-icon://payment-approval"
											press=".onPayNow"
											visible="{= ${bills>status} !== 'Paid' }"
											class="sapUiTinyMarginEnd"/>
										<Button
											id="downloadReceiptBtn"
											text="Download"
											icon="sap-icon://download"
											tooltip="Download Receipt"
											press=".onDownloadReceipt"
											enabled="{= ${bills>status} === 'Paid' }"/>
									</HBox>
								</cells>
							</ColumnListItem>
						</items>
					</Table>
				</Panel>
			</VBox>
		</f:content>
	</f:DynamicPage>
</mvc:View>